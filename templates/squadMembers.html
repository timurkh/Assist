<script> document.getElementById("navbar-squads").classList.add("active"); </script>

<script> var squadId = "{{.SquadID}}"; </script>

<div id="app">
	<div v-if="loading">
		<div class="d-flex justify-content-center mt-5">
			<div class="spinner-border mt-5" role="status">
				<span class="sr-only">Loading...</span>
			</div>
		</div>
	</div>
	<div v-if="!loading" v-cloak>

		<!-- Modal Windows -->
		<div class="modal fade" id="addMemberModal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="changeMemberStatusModalLabel">Add Member <i class="fas fa-robot"></i></h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<form>
							<div class="form-group">

								<label for="displayName">Name</label>
								<input type="text" id="displayName" class="form-control" v-model="replicant.displayName">
								<label for="Email">Email</label>
								<input type="text" id="Email" class="form-control" v-model="replicant.email">
								<label for="PhoneNumber">Phone</label>
								<input type="text" id="PhoneNumber" class="form-control" v-model="replicant.phoneNumber">
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" v-on:click="addMember()" data-dismiss="modal">Add</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="changeMemberStatusModal" tabindex="-1" role="dialog">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="changeMemberStatusModalLabel">[[changeStatusMember.displayName]] Status</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<form>
							<div class="form-group">
								<select v-model="statusToSet" class="form-control" size="3">
									<option  v-for="i in 3" :value="i-1">[[getStatusText(i-1)]]</option>
								</select>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-primary" v-on:click="setMemberStatus()" data-dismiss="modal">Set Selected Status</button>
					</div>
				</div>
			</div>
		</div>
		<!-- Main View -->
		<div v-if="error_message.length > 0" class="alert alert-danger m-1" role="alert">
			[[ error_message ]]
		</div>

		<div class="container-fluid m-0 p-0">
			<div class="d-flex flex-wrap">
				<div class="breadcrumb justify-content-between align-items-center flex-grow-1 p-1 m-1">
					<ol class="breadcrumb mb-0 p-0">
						<li class="breadcrumb-item">My Squads</li>
						<li class="breadcrumb-item active">Squad "{{.SquadID}}"</li>
					</ol>
				</div>
				<div v-if="squadId != `All Users`" class="ml-auto p-0 m-1">
					<button type="button" class="btn btn-info add-new p-1" data-toggle="modal" data-target="#addMemberModal"><i class="fa fa-plus"></i> Add New Member</button>
				</div>
			</div>

			<div class="table-responsive-lg m-0 p-1">
				<table class="table table-sm table-bordered m-0">
					<thead class="thead-dark text-truncate">
						<tr class="d-flex">
							<th class="col-md-3 col-4 text-truncate">Member</th>
							<th class="col-md-3 d-none d-md-table-cell text-truncate">Email</th>
							<th class="col-md-2 d-none d-md-table-cell text-truncate">Phone</th>
							<th class="col-md-1 col-2 text-truncate">Status</th>
							<th class="col-md-2 col-3 text-truncate">Tags</th>
							<th class="col-md-1 col-3 text-truncate">Actions</th>
					</thead>
					<tbody>
						<tr class="d-flex" v-for="(member, index) in squad_members"  >
							<td class="col-md-3 col-4 text-truncate" :title="member.displayName"> 
								<i v-if="member.replicant" class="fas fa-robot" style="color: Dodgerblue"></i>
								[[member.displayName]]
						   	</td>
							<td class="col-md-3 d-none d-md-table-cell text-truncate" :title="member.email"> [[member.email]] </td>
							<td class="col-md-2 d-none d-md-table-cell text-truncate" :title="member.phoneNumber"> [[member.phoneNumber]] </td>
							<td class="col-md-1 col-2 text-truncate" :title="getStatusText(member.status)" > [[getStatusText(member.status)]] </td>
							<td class="col-md-2 col-3 text-truncate"> </td>
							<td class="col-md-1 col-3 text-truncate"> 
								<div class="d-flex justify-content-center">
									<div v-if="member.status != 3" class="px-1">
										<a title="Change member status" data-toggle="tooltip" v-on:click="changeStatus(index, member)" href="#"><i class="fas fa-edit fa-lg"></i></a>
									</div>
									<div v-if="member.status != 3" class="px-1">
										<a title="Remove Member" data-toggle="tooltip" v-on:click="removeMember(member.id, index)" href="#"><i class="fas fa-sign-out-alt fa-lg"></i></a>
									</div>
								</div>
							
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<script src="/static/squadMembers.js"></script>
